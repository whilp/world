# skill: integrate pr.lua into cosmic-lua

Adds skill dispatcher module to cosmic-lua, enabling `cosmic-lua -l skill update-pr` for PR management instead of running pr.lua as standalone script.

The skill module provides a clean extension point for adding more cosmic-lua subcommands in the future.

## Implementation

- lib/skill/init.lua - dispatcher that reads arg table for subcommands and routes to handlers
- lib/skill/pr.lua - PR update implementation (moved from lib/build/)
- lib/skill/test_pr.lua - comprehensive unit tests for PR parsing and GitHub API (resurrected from build.orig)
- lib/skill/cook.mk - build rules for skill modules, bundled into cosmic binary
- lib/cosmic/test_skill_pr.lua - integration tests for skill module loading and update-pr behavior
- lib/cosmic/cook.mk - cosmic build bundles skill modules
- Makefile - update-pr target prefers cosmic but falls back to bootstrap cosmic

## Design

The dispatcher pattern checks the arg table for known subcommands and rebuilds arg with subcommand-specific arguments before dispatching. Currently supports update-pr, easily extensible for more skills.

The skill module is self-contained with its own implementation (pr.lua) and tests (test_pr.lua), making it easy to add more skills in the future.

## Validation

- [x] tests pass (lib/cosmic/test_skill_pr.lua, lib/skill/test_pr.lua)
- [x] make update-pr works locally with cosmic
- [x] make update-pr falls back to bootstrap cosmic when cosmic binary unavailable (CI compatible)
- [x] cosmic-lua -l skill update-pr shows help outside GitHub Actions
- [x] integration preserves existing pr.lua behavior

<details>
<summary>PR metadata</summary>

- **Title/description last updated**: 2026-01-03 22:13:30 UTC

</details>
