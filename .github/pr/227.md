# checker: extract common functionality into shared module

Eliminates duplication across checker runners and reporters by extracting shared patterns into `lib/checker/common.lua`. Reduces codebase by ~400 lines while creating a single source of truth for common checker logic.

## Implementation

- lib/checker/common.lua - shared utilities for runners and reporters
- lib/checker/cook.mk - module configuration
- lib/checker/test_common.lua - comprehensive tests for common module
- 3p/ast-grep/{run,report}-astgrep.lua - refactored to use common module
- 3p/luacheck/{run,report}-luacheck.lua - refactored to use common module
- 3p/tl/{run,report}-teal.lua - refactored to use common module
- lib/build/check-report.lua - refactored to use common module
- lib/test/report-test.lua - refactored to use common module

## Extracted functions

### Runners share
- `format_output(status, message, stdout, stderr)` - identical output formatting
- `has_extension(file, extensions)` - file extension validation
- `check_first_lines(file, patterns)` - shebang and ignore directive detection

### Reporters share
- `parse_result(content)` - identical result parsing from formatted output
- `strip_prefix(filepath)` - TEST_O path prefix stripping
- `status_icons()` - status symbols (✓, ✗, →, ○)
- `categorize_results(results_list)` - bucket results by status
- `format_results(all_results, icons)` - returns formatted result lines
- `format_summary(checker_name, results)` - returns summary line
- `format_failures(all_results)` - returns detailed failure output

## Design

The common module uses pure functions that accept configuration as parameters rather than hardcoding behavior. For example, `check_first_lines()` takes a `patterns` table with `shebangs` and `ignore` keys, allowing each checker to define its own detection patterns while sharing the implementation.

The `format_*` functions return strings rather than printing directly, making them testable and allowing callers to control output.

This approach:
- Preserves checker-specific behavior (different ignore patterns, file extensions)
- Eliminates duplication of identical logic
- Makes future checker additions simpler (inherit common behavior)
- Centralizes fixes and improvements to shared code

## Validation

- [x] all tests pass (32 passed, 0 failed, 1 skipped)
- [x] common.lua appears in make check output
- [x] ast-grep checker unchanged behavior
- [x] luacheck checker unchanged behavior
- [x] teal checker unchanged behavior
- [x] test reporter unchanged behavior
- [x] multi-checker reporter unchanged behavior
- [x] common module fully tested
- [x] TEST_O with custom value works (no hardcoded o/)
