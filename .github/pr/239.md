# cosmic: add dispatcher with .args and fix test isolation

The cosmic binary now uses a .args-based dispatcher to intercept arguments before lua's normal processing, enabling cosmic-specific features while maintaining full lua compatibility. Tests are properly isolated from the development environment's LUA_PATH.

- lib/cosmic/main.lua - dispatcher that processes lua flags (-e, -l, etc.) manually and handles cosmic-specific --skill and --help flags
- lib/cosmic/.args - points to /zip/main.lua to run dispatcher on every invocation
- lib/cosmic/cook.mk - updated build to bundle main.lua and .args into cosmic binary
- lib/cosmic/test_binary.lua - added clean_env() helper to remove LUA_PATH from test environment
- lib/cosmic/test_skill_pr.lua - updated to use clean_env() for proper test isolation

## Key decisions

- **.args approach**: Using .args intercepts all arguments before lua processes them, giving us control over dispatch. This requires manually implementing lua flag processing but enables cosmic-specific features like --skill
- **Manual lua flag processing**: Since .args prevents lua from handling flags natively, the dispatcher implements -e, -l, -v, and script execution manually to maintain compatibility
- **Test isolation**: Tests now run cosmic with clean environment (no LUA_PATH) to verify bundled libraries are correctly embedded, not loaded from repo sources
- **--skill dispatch**: More intuitive than `-l skill update-pr`; directly runs skill modules with proper arg table setup
- **Module help system**: --help [module] displays _VERSION, _DESCRIPTION, and _USAGE from module metadata

## Validation

- [x] tests pass
- [x] all cosmic tests verify bundled modules without LUA_PATH
- [x] cosmic --help shows enhanced help
- [x] cosmic --help skill shows module information
- [x] cosmic --skill pr runs skill correctly
- [x] cosmic -e, -l, -v work as expected
- [x] backward compatible with existing usage
