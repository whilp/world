#!/usr/bin/env luajit

local posix = require('posix')

local status, reason = posix.spawn({"defaults", "write", "com.apple.dock", "autohide", "-bool", "true"})
if reason ~= 'exited' or status ~= 0 then
  io.stderr:write("dock-hide: failed to set autohide\n")
  os.exit(status or 1)
end

status, reason = posix.spawn({"killall", "Dock"})
if reason ~= 'exited' or status ~= 0 then
  io.stderr:write("dock-hide: failed to restart Dock\n")
  os.exit(status or 1)
end
